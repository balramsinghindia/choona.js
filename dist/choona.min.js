var choona={};choona.klass=function(){"use strict";var a=function(b){var c,d=function(){"function"==typeof b.initialize&&b.initialize.apply(this,arguments)};void 0!==this&&this.extend===a?c=this:(c={},c.prototype={}),d.prototype=Object.create(c.prototype),d.prototype.constructor=d;for(var e in b)b.hasOwnProperty(e)&&(d.prototype[e]=b[e]);return d.extend=a,d.parent=c,d};return a.Singleton=function(b){var c=a(b),d=new c;return function(){return d}},a}(),choona.Base=choona.klass({}),function(){"use strict";choona.Settings={Global:{preStart:function(){},postEnd:function(){},templateStrToHtml:function(a){return a}},debug:!1,isConsoleAvailable:!1}}(),function(){"use strict";choona.Util={log:function(a){choona.Settings.debug===!0&&choona.Settings.isConsoleAvailable===!0&&console.log(a)},logError:function(a){choona.Settings.debug===!0&&choona.Settings.isConsoleAvailable===!0&&console.error(a)},"for":function(a,b){for(var c in a)a.hasOwnProperty(c)&&b(a[c],c)}}}(),function(){"use strict";choona.EventBus=choona.Base.extend({initialize:function(){this._NewsPaperList={},this._OrderList=[]},on:function(){return this.subscribe.apply(this,arguments)},subscribe:function(a,b){if("string"!=typeof a||"function"!=typeof b)return-1;var c=this._NewsPaperList[a];"object"!=typeof c&&(c=this._NewsPaperList[a]=[]);var d=c.push(b)-1;return this._OrderList.push({newsPaper:a,customer:d})-1},off:function(){return this.unsubscribe.apply(this,arguments)},unsubscribe:function(a){var b=this._OrderList[a];void 0!==b&&delete this._NewsPaperList[b.newsPaper][b.customer]},trigger:function(){this.publish.apply(this,arguments)},publish:function(){var a=Array.prototype.slice.call(arguments),b=a.slice(0,1)[0];a.shift();var c=this._NewsPaperList[b];if("undefined"!=typeof c)for(var d=c.length,e=0;d>e;e++)"function"==typeof c[e]&&c[e].apply(this,a)}})}(),function(){"use strict";choona.Model=choona.EventBus.extend({initialize:function(){choona.EventBus.call(this)},publishModalChanges:function(){this.publish("change")}})}(),function(){"use strict";var a="undefined"!=typeof Element&&Element.prototype||{},b=a.addEventListener||function(a,b){return this.attachEvent("on"+a,b)},c=a.removeEventListener||function(a,b){return this.detachEvent("on"+a,b)};a.matchesSelector=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.msMatchesSelector,a.matches||(a.matches=a.matchesSelector),choona.BaseModule=choona.Base.extend({initialize:function(a,b,c,d){choona.BaseModule.parent.call(this),this.$=b,this.config=c,this._sandBoxData={eventBus:d,topicList:{},subModuleList:{},id:a,domEvents:[]},this._setUpjQueryElement(),this._loadTemplate(),this._startIsolatedEventBus(),this._subscribeAllSandboxEvents(),this._subscribeDomEvents(),this._callPreStart(),this._startModule()},_startModule:function(){if("function"!=typeof this.start)throw new Error("moduleConf.module.start is undefined for moduleConf.id = "+this._sandBoxData.id);this.start(),choona.Util.log("started module -> "+this._sandBoxData.id)},_loadTemplate:function(){"string"==typeof this.template&&(this.$.innerHTML=this.template),"function"==typeof this.template&&(this.$.innerHTML=this.template())},_startIsolatedEventBus:function(){this.isolatedEventBus===!0&&(this._sandBoxData.eventBus=this._getNewEventBus())},_getNewEventBus:function(){return new choona.EventBus},_getEventBus:function(){return this._sandBoxData.eventBus},_setUpjQueryElement:function(){jQuery&&(this.$el=this.$$=jQuery(this.$))},subscribeSandboxEvent:function(a,b){void 0===this._sandBoxData.topicList[a]&&(this._sandBoxData.topicList[a]=[]);var c=this._getEventBus();this._sandBoxData.topicList[a].push(c.subscribe(a,b)),choona.Util.log("subscribed topic -> "+a)},_subscribeAllSandboxEvents:function(){var a=this;void 0!==this.sandboxEvents&&choona.Util.for(this.sandboxEvents,function(b,c){a.subscribeSandboxEvent(c,function(){a[b].apply(a,arguments)})})},unSubscribeSandboxEvent:function(a){choona.Util.log("unsubscribing topic -> "+a);var b=this._getEventBus();void 0!==this._sandBoxData.topicList[a]&&(this._sandBoxData.topicList[a].map(function(a){b.unsubscribe(a)}),delete this._sandBoxData.topicList[a])},publishSandboxEvent:function(a,b){choona.Util.log("publishing topic ->"+a+" = "+b);var c=this._getEventBus();c.publish.apply(c,arguments)},startSubModule:function(a){if("string"!=typeof a.id||""===a.id)throw new Error("Id provided is not String or it is a blank sting");if(void 0!==this._sandBoxData.subModuleList[a.id])throw new Error("data.id::"+a.id+" is already contains a module.  Please provide separate id new module");this._sandBoxData.subModuleList[a.id]=new choona.Application(a,{parentNode:this.$,parentEventBus:this._getEventBus()})},endSubModule:function(a){this._sandBoxData.subModuleList[a].endApplication(),delete this._sandBoxData.subModuleList[a]},_subscribeDomEvents:function(){var a=this;void 0!==a.domEvents&&choona.Util.for(a.domEvents,function(c,d){{var e=d.split(" "),f=e.shift(),g=e.join(" "),h=function(b){""===g?a[c].call(a,b,b.target):b.target.matches(g)&&a[c].call(a,b,b.target)};b.call(a.$,f,h,!1)}a._sandBoxData.domEvents.push({eventName:f,callback:h})})},_callPreStart:function(){"function"==typeof choona.Settings.Global.preStart&&choona.Settings.Global.preStart.call(this)},_endModuleResources:function(){var a=this;choona.Util.for(this._sandBoxData.subModuleList,function(b,c){a.endSubModule(c)}),"function"==typeof this.end&&this.end(),a._sandBoxData.domEvents.map(function(b){c.call(a.$,b.eventName,b.callback)}),this.$.innerHTML="",choona.Util.for(this._sandBoxData.topicList,function(b,c){a.unSubscribeSandboxEvent(c)}),delete this.$,delete this.$el,delete this.$$,delete this.config,choona.Util.log("ended module -> "+this._sandBoxData.id),delete this._sandBoxData.id,delete this._sandBoxData.subModuleList,delete this._sandBoxData.eventBus,delete this._sandBoxData.topicList,delete this._sandBoxData.domEvents,delete this._sandBoxData}})}(),function(){"use strict";choona.Sandbox=choona.Base.extend({})}(),function(){"use strict";choona.Settings.GlobalEventBus=new choona.EventBus,choona.Application=choona.Base.extend({initialize:function(a,b){choona.Application.parent.call(this);var c,d,e=a.id,f=a.module,g=a.config;if(void 0!==b?(d=b.parentEventBus,c=b.parentNode.querySelector("#"+e)):(d=choona.Settings.GlobalEventBus,c=document.querySelector("#"+e)),"string"!=typeof e||""===e)throw new Error("Id provided is not String or it is a blank sting");if(null===c)throw new Error('Unable to Load Module, as I am unable to find id="'+this.id+'" inside Root DOM');if(void 0===f&&"object"!=typeof f)throw new Error("moduleConf.module is undefined or not an object for moduleConf.id = "+this.id);f.initialize=function(){choona.BaseModule.apply(this,arguments)};var h=choona.BaseModule.extend(f);this.module=new h(e,c,g,d)},endApplication:function(){this.module._endModuleResources(),delete this.module}})}();